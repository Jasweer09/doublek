<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Horse Auction - Homepage</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/css/bootstrap.min.css">
    <style>
        body {
            background: linear-gradient(to right, #141e30, #243b55);
            color: #f0f0f0;
            font-family: 'Arial', sans-serif;
            margin: 0;
            padding: 0;
        }

        /* Header */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 50px;
            background: rgba(31, 41, 55, 0.95);
            position: sticky;
            top: 0;
            width: 100%;
            z-index: 10;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
            transition: background-color 0.3s ease;
        }

        .header:hover {
            background-color: rgba(31, 41, 55, 1);
        }

        .header .logo h1 {
            font-size: 2rem;
            font-weight: bold;
            margin: 0;
            letter-spacing: 2px;
            color: #ffffff;
        }

        .header .nav-links {
            display: flex;
            gap: 20px;
        }

        .header .nav-links a {
            text-decoration: none;
            color: #ffffff;
            font-weight: 500;
            padding: 10px 15px;
            border-radius: 5px;
            transition: color 0.3s ease, background-color 0.3s ease;
        }

        .header .nav-links a:hover {
            color: #38bdf8;
            background-color: rgba(255, 255, 255, 0.1);
        }

        /* User Dropdown */
        .user-dropdown {
            position: relative;
            display: inline-block;
        }

        .user-dropdown button {
            background-color: transparent;
            color: #ffffff;
            border: none;
            font-size: 1.1rem;
            cursor: pointer;
            display: flex;
            align-items: center;
        }

        .user-dropdown button img {
            border-radius: 50%;
            width: 30px;
            height: 30px;
            margin-right: 10px;
        }

        .user-dropdown-content {
            display: none;
            position: absolute;
            right: 0;
            background-color: #1f2937;
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2);
            z-index: 1;
            min-width: 150px;
            border-radius: 5px;
        }

        .user-dropdown-content a {
            color: #ffffff;
            padding: 12px 16px;
            text-decoration: none;
            display: block;
        }

        .user-dropdown-content a:hover {
            background-color: #38bdf8;
            color: #000;
        }

        

        /* Hero Banner */
        .hero {
            height: 600px;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            color: #ffffff;
            position: relative;
        }

        .hero::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1;
        }

        .hero-content {
            position: relative;
            z-index: 2;
        }

        .hero h1 {
            font-size: 3.5rem;
            font-weight: bold;
            margin-bottom: 20px;
            text-shadow: 0 4px 10px rgba(0, 0, 0, 0.4);
        }

        .hero p {
            font-size: 1.2rem;
            margin-bottom: 30px;
        }

        .hero .btn {
            background: #38bdf8;
            border: none;
            color: #ffffff;
            padding: 15px 30px;
            font-size: 1.1rem;
            font-weight: bold;
            border-radius: 8px;
            cursor: pointer;
            transition: background-color 0.3s ease, transform 0.3s ease;
        }

        .hero .btn:hover {
            background: #1e3a8a;
            transform: scale(1.05);
        }
        /* Cards Section */
        .cards-section {
            padding: 50px 5%;
            text-align: center;
            background: linear-gradient(135deg, #1f2937, #0d1117);
        }

        .cards-container {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            justify-content: center;
        }

        .card {
            background: #1f2937;
            border-radius: 10px;
            overflow: hidden;
            width: 300px;
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.2);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .card:hover {
            transform: translateY(-10px);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }

        .card img {
            width: 100%;
            height: 200px;
            object-fit: cover;
        }

        .card-body {
            padding: 20px;
            text-align: center;
        }

        .card-body h5 {
            font-size: 1.3rem;
            margin-bottom: 10px;
            font-weight: bold;
            color: #ffffff;
        }

        .card-body p {
            font-size: 0.9rem;
            color: #9ca3af;
        }

        .card-body .price {
            color: #38bdf8;
            font-weight: bold;
            margin-top: 10px;
        }

        /* Footer */
        .footer {
            background: #1f2937;
            color: #9ca3af;
            padding: 20px;
            text-align: center;
            border-top: 1px solid #374151;
        }

        .about-section,
        .contact-section {
        background: linear-gradient(135deg, #1f2937, #0d1117);
        border-radius: 10px;
        box-shadow: 0 8px 30px rgba(0, 0, 0, 0.4);
        margin-bottom: 20px;
        padding: 50px 5%;
        text-align: center;
    }
    /* Profile Modal Styling */
.modal-content {
    background-color: #1f2937; /* Dark background */
    color: #f0f0f0; /* Light text color */
}

.modal-header {
    border-bottom: 1px solid #374151; /* Light border */
}

.modal-body {
    color: #f0f0f0; /* Light text in the modal body */
}

.modal-title {
    color: #38bdf8; /* Highlighted title color */
}

.modal-body span {
    color: #ffffff; /* Ensure text inside the modal body is white */
}

.modal-footer button {
    background-color: #38bdf8; /* Button color */
    color: #000000; /* Text color on the button */
}

.modal-footer button:hover {
    background-color: #1e3a8a; /* Hover state for the button */
    color: #ffffff; /* Text color on hover */
}
    </style>
</head>

<body>
    <!-- Header -->
    <header class="header">
        <div class="logo">
            <h1>DoubleK</h1>
        </div>
        <nav class="nav-links">
            <a href="#buySection">Home</a>
            <a href="#heroSection">Upcoming Auctions</a>
            <a href="#aboutSection">About</a>
            <a href="#contactSection">Contact</a>
        </nav>
        
        <!-- User Info Dropdown -->
        <div class="user-dropdown">
            <button class="btn dropdown-toggle text-white" type="button" id="userDropdown" data-bs-toggle="dropdown" aria-expanded="false">
                <i class="bi bi-person-circle me-1"></i> <span id="userName">User</span>
            </button>
            <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="userDropdown">
                <li><a class="dropdown-item" href="#" id="profileLink">Profile</a></li>
                <li><a class="dropdown-item" href="#" id="logoutLink">Logout</a></li>
            </ul>
        </div>
    </header>
    

    <!-- Buy Your Dream Horse Section -->
    <section class="cards-section" id="buySection">
        <h2>Buy Your Dream Horse</h2>
        <p>Explore our exclusive collection of horses available for purchase.</p>
        <div class="cards-container" id="cardsSection">
            <!-- Dynamic content -->
        </div>
        <div style="text-align: center; margin: 20px;">
            <button id="viewMoreButton" class="btn btn-primary">View More</button>
        </div>
    </section>

    <!-- Hero Section -->
    <section class="hero" id="heroSection">
        <div class="hero-content" >
            <h1>View Upcoming Auctions</h1>
            <p>Join our exclusive auctions and bid for the finest horses across the world.</p>
            <a href="upcomingauctions.html" class="btn">View Auctions</a>
        </div>
    </section>

    <section id="aboutSection" class="about-section">
        <h2>About Us</h2>
        <p>
            DoubleK Horse Auction is dedicated to connecting horse lovers with their dream horses. 
            With years of experience in the equestrian industry, we ensure that every horse listed meets the 
            highest standards of health, temperament, and performance. Whether you're a first-time buyer or 
            a seasoned equestrian, our platform offers a seamless and trustworthy auction experience.
        </p>
    </section>

    <section id="contactSection" class="contact-section">
        <h2>Contact Us</h2>
        <p>We’d love to hear from you! Whether you have questions about an auction or need assistance, feel free to reach out.</p>
        <p>Email: <a href="mailto:support@doublek.com" style="color: #38bdf8;">support@doublek.com</a></p>
        <p>Phone: <a href="tel:+1234567890" style="color: #38bdf8;">+1 234 567 890</a></p>
        <p>Address: 123 Equestrian Lane, Horseville, USA</p>
    </section>
    
    <div class="modal fade" id="profileModal" tabindex="-1" aria-labelledby="profileModalLabel" >
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="profileModalLabel">Profile</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <p><strong>First Name:</strong> <span id="profileFirstName">John</span></p>
                    <p><strong>Last Name:</strong> <span id="profileLastName">Doe</span></p>
                    <p><strong>User ID:</strong> <span id="profileUserId">UserId</span></p>
                    <p><strong>Email ID:</strong> <span id="profileEmail">Test@gmail.com</span></p>
                    <p><strong>Phone No:</strong> <span id="profilePhone">1234567890</span></p>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="footer">
        <p>© 2024 Horse Auction. All rights reserved.</p>
    </footer>
    <script>
        let currentPage = 1; // To track the current page of data
        const cardsPerPage = 4; // Number of cards to display per load
    
        // Function to check if a URL is valid
        function isValidUrl(url) {
            try {
                new URL(url); // Try to create a URL object
                return true;
            } catch (e) {
                return false; // If URL creation fails, it's not a valid URL
            }
        }
    
        // Function to load horses
        async function loadHorses() {
            try {
                const response = await fetch(`/api/horses?page=${currentPage}`);
                const horses = await response.json();
                const cardsSection = document.getElementById('cardsSection');
                const viewMoreButton = document.getElementById('viewMoreButton');
    
                if (!horses || horses.length === 0) {
                    // Hide the "View More" button if no more horses are available
                    viewMoreButton.style.display = 'none';
                    return;
                }
    
                horses.slice(0, cardsPerPage).forEach((horse) => {
                    const card = document.createElement('div');
                    card.classList.add('card');
                    
                    const image = document.createElement('img');
                    image.alt = horse.name;
                    
                    // Check if image_url is available and is valid
                    if (horse.image_url && isValidUrl(horse.image_url)) {
                        image.src = horse.image_url;
                        console.log(image.src);
                    } else {
                        image.src = 'https://via.placeholder.com/300x200'; // Fallback image
                    }
    
                    // Insert image dynamically and build the card content
                    card.innerHTML = `
                        <div class="card-body">
                            <h5>${horse.name}</h5>
                            <p>${horse.location}</p>
                            <p class="price">${horse.price}$</p>
                        </div>
                    `;
    
                    // Add the image to the card
                    card.insertBefore(image, card.firstChild);
    
                    // Add click event to redirect to the horse details page
                    card.addEventListener('click', () => {
                        console.log(horse.horse_id);
                        window.location.href = `horse-details.html?id=${horse.horse_id}`;
                    });
    
                    cardsSection.appendChild(card);
                });
    
                // Increment current page for the next batch of horses
                currentPage++;
    
                // Hide the "View More" button if fewer than 4 horses are loaded
                if (horses.length < cardsPerPage) {
                    viewMoreButton.style.display = 'none';
                }
            } catch (error) {
                console.error('Error loading horses:', error);
                alert('Failed to load horses. Please try again later.');
            }
        }
    
        // Load the first set of cards on page load
        document.addEventListener('DOMContentLoaded', () => {
            loadHorses();
        });
    
        // Attach event listener to "View More" button
        document.getElementById('viewMoreButton').addEventListener('click', () => {
            loadHorses();
        });
    
        // User Info Handling (Profile & Logout)
        document.addEventListener("DOMContentLoaded", function () {
    // Profile Modal instance
    const profileModalElement = document.getElementById('profileModal');
    const profileModal = new bootstrap.Modal(profileModalElement);  // Use bootstrap.Modal to handle the modal

    document.getElementById('profileLink').addEventListener('click', function() {
        // Get user info from local storage (you can adjust to get real data)
        const firstName = localStorage.getItem("firstName") || "John";
        const lastName = localStorage.getItem("lastName") || "Doe";
        const userId = localStorage.getItem("userID") || "UserId";
        const email = localStorage.getItem("email") || "Test@gmail.com";
        const phone = localStorage.getItem("phone") || "0123456789";

        // Populate modal with user information
        document.getElementById('profileFirstName').textContent = firstName;
        document.getElementById('profileLastName').textContent = lastName;
        document.getElementById('profileUserId').textContent = userId;
        document.getElementById('profileEmail').textContent = email;
        document.getElementById('profilePhone').textContent = phone;

        // Show the modal
        profileModal.show();  // This will open the modal
    });

    // Ensure the modal backdrop is removed when the modal is closed
    profileModalElement.addEventListener('hidden.bs.modal', function () {
        document.body.classList.remove('modal-open'); // Ensures body scroll is restored
        document.querySelectorAll('.modal-backdrop').forEach(backdrop => backdrop.remove());
    });

    // Logout functionality
    document.getElementById('logoutLink').addEventListener('click', function() {
        localStorage.clear(); // Clear user data
        sessionStorage.clear(); // Clear session storage
        window.location.replace('/login.html'); // Redirect to login page
    });

    // Prevent back navigation after logout
    window.onpageshow = function(event) {
        if (event.persisted) {
            window.location.replace('/login.html');
        }
    };
});

    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/js/bootstrap.bundle.min.js"></script>
</body>

</html>
